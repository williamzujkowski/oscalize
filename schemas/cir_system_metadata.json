{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://oscalize.local/schemas/cir_system_metadata.json",
  "title": "CIR System Metadata Schema",
  "description": "Canonical Intermediate Representation for system metadata and FIPS-199 categorization",
  "type": "object",
  "properties": {
    "system_identification": {
      "type": "object",
      "properties": {
        "system_name": { "type": "string" },
        "system_name_short": { "type": "string" },
        "system_id": { "type": "string" },
        "system_description": { "type": "string" },
        "system_version": { "type": "string" },
        "system_owner": { "type": "string" },
        "authorizing_official": { "type": "string" },
        "information_system_type": { 
          "type": "string",
          "enum": ["General Support System", "Major Application", "Minor Application"]
        }
      },
      "required": ["system_name", "system_id", "system_description"]
    },
    "fips199_categorization": {
      "type": "object",
      "properties": {
        "confidentiality": { 
          "type": "string",
          "enum": ["Low", "Moderate", "High"]
        },
        "integrity": { 
          "type": "string",
          "enum": ["Low", "Moderate", "High"]
        },
        "availability": { 
          "type": "string",
          "enum": ["Low", "Moderate", "High"]
        },
        "overall_impact": { 
          "type": "string",
          "enum": ["Low", "Moderate", "High"]
        },
        "rationale": { "type": "string" }
      },
      "required": ["confidentiality", "integrity", "availability", "overall_impact"]
    },
    "operational_environment": {
      "type": "object",
      "properties": {
        "cloud_service_model": {
          "type": "string",
          "enum": ["IaaS", "PaaS", "SaaS", "Other"]
        },
        "deployment_model": {
          "type": "string",
          "enum": ["Public", "Private", "Community", "Hybrid"]
        },
        "service_layers": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "authorization_boundary": {
      "type": "object",
      "properties": {
        "description": { "type": "string" },
        "diagram_references": {
          "type": "array",
          "items": { "type": "string" }
        },
        "network_architecture": { "type": "string" }
      }
    },
    "stakeholders": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "role": { "type": "string" },
          "name": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "organization": { "type": "string" },
          "phone": { "type": "string" }
        },
        "required": ["role", "name"]
      }
    },
    "compliance_frameworks": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "framework": { "type": "string" },
          "version": { "type": "string" },
          "baseline": { "type": "string" }
        },
        "required": ["framework", "version"]
      }
    },
    "source_metadata": {
      "type": "object",
      "properties": {
        "extraction_date": { "type": "string", "format": "date-time" },
        "source_files": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "file": { "type": "string" },
              "type": { "type": "string" },
              "hash": { "type": "string" },
              "sections": {
                "type": "array",
                "items": { "type": "string" }
              }
            },
            "required": ["file", "type", "hash"]
          }
        }
      },
      "required": ["extraction_date", "source_files"]
    }
  },
  "required": ["system_identification", "fips199_categorization", "source_metadata"]
}